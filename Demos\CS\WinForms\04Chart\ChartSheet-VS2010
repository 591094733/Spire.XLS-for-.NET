		private void btnRun_Click(object sender, System.EventArgs e)
		{
			Workbook workbook = new Workbook();
			
			//Initailize worksheet
			workbook.CreateEmptySheets(1);
			Worksheet sheet = workbook.Worksheets[0];
			sheet.Name = "Chart data";

			//Writes chart data
			CreateChartData(sheet);
            //Add a new  chart worsheet to workbook
			ChartSheet chartsheet = workbook.Charts.Add("chart worksheet");
			//Set region of chart data
			chartsheet.DataRange = sheet.Range["A1:B5"];
			chartsheet.SeriesDataFromRange = false;

            //Chart title
			chartsheet.ChartTitle = "Sales market by country";
			chartsheet.ChartTitleArea.IsBold = true;
			chartsheet.ChartTitleArea.Size = 12;

			chartsheet.PrimaryCategoryAxis.Title = "Country";
			chartsheet.PrimaryCategoryAxis.Font.IsBold = true;
			chartsheet.PrimaryCategoryAxis.TitleArea.IsBold = true;

			chartsheet.PrimaryValueAxis.Title = "Sales(in Dollars)";
			chartsheet.PrimaryValueAxis.HasMajorGridLines = false;
			chartsheet.PrimaryValueAxis.TitleArea.TextRotationAngle = 90;
            chartsheet.PrimaryValueAxis.MinValue = 1000;
			chartsheet.PrimaryValueAxis.TitleArea.IsBold = true;


            foreach (Charts.ChartSerie cs in chartsheet.Series)
            {
			    cs.Format.Options.IsVaryColor = true;
			    cs.DataPoints.DefaultDataPoint.DataLabels.HasValue = true;
            }

			chartsheet.Legend.Position = LegendPositionType.Top;
			workbook.SaveToFile("Sample.xls");
		}

		private void CreateChartData(Worksheet sheet)
		{
			//Country
			sheet.Range["A1"].Value = "Country";
			sheet.Range["A2"].Value = "Cuba";
			sheet.Range["A3"].Value = "Mexico";
			sheet.Range["A4"].Value = "France";
			sheet.Range["A5"].Value = "German";

			//Sales
			sheet.Range["B1"].Value = "Sales";
			sheet.Range["B2"].NumberValue = 6000;
			sheet.Range["B3"].NumberValue = 8000;
			sheet.Range["B4"].NumberValue = 9000;
			sheet.Range["B5"].NumberValue = 8500;

			//Style
			sheet.Range["A1:B1"].Style.Font.IsBold = true;
			sheet.Range["A2:B2"].Style.KnownColor = ExcelColors.LightYellow;
			sheet.Range["A3:B3"].Style.KnownColor = ExcelColors.LightGreen1;
			sheet.Range["A4:B4"].Style.KnownColor = ExcelColors.LightOrange;
			sheet.Range["A5:B5"].Style.KnownColor = ExcelColors.LightTurquoise;

			//Border
			sheet.Range["A1:B5"].Style.Borders[BordersLineType.EdgeTop].Color = Color.FromArgb(0, 0, 128);
			sheet.Range["A1:B5"].Style.Borders[BordersLineType.EdgeTop].LineStyle = LineStyleType.Thin;
			sheet.Range["A1:B5"].Style.Borders[BordersLineType.EdgeBottom].Color = Color.FromArgb(0, 0, 128);
			sheet.Range["A1:B5"].Style.Borders[BordersLineType.EdgeBottom].LineStyle = LineStyleType.Thin;
			sheet.Range["A1:B5"].Style.Borders[BordersLineType.EdgeLeft].Color = Color.FromArgb(0, 0, 128);
			sheet.Range["A1:B5"].Style.Borders[BordersLineType.EdgeLeft].LineStyle = LineStyleType.Thin;
			sheet.Range["A1:B5"].Style.Borders[BordersLineType.EdgeRight].Color = Color.FromArgb(0, 0, 128);
			sheet.Range["A1:B5"].Style.Borders[BordersLineType.EdgeRight].LineStyle = LineStyleType.Thin;

			sheet.Range["B2:B5"].Style.NumberFormat = "\"$\"#,##0";
		}
